<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - {% block title %}{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ui-timepicker-addon/1.6.3/jquery-ui-timepicker-addon.min.js"></script>

</head>
<body>
    <div class="wrapper">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h3>Admin Bot</h3>
            </div>
            <ul class="sidebar-nav">
                <li>
                    <a href="{{ url_for('index') }}" class="nav-link {% if request.endpoint == 'index' %}active{% endif %}">
                        <span class="material-icons">dashboard</span>
                        Dashboard
                    </a>
                </li>
                <li>
                    <a href="{{ url_for('produtos') }}" class="nav-link {% if request.endpoint == 'produtos' %}active{% endif %}">
                        <span class="material-icons">inventory_2</span>
                        Produtos
                    </a>
                </li>
                <li>
                    <a href="{{ url_for('vendas') }}" class="nav-link {% if request.endpoint == 'vendas' %}active{% endif %}">
                        <span class="material-icons">shopping_cart</span>
                        Vendas
                    </a>
                </li>
                <li>
                    <a href="{{ url_for('usuarios') }}" class="nav-link {% if request.endpoint == 'usuarios' %}active{% endif %}">
                        <span class="material-icons">people</span>
                        Usuários
                    </a>
                </li>
                <li>
                    <a href="{{ url_for('manage_comunidades') }}" class="nav-link {% if request.endpoint == 'manage_comunidades' or request.endpoint == 'adicionar_comunidade' or request.endpoint == 'editar_comunidade' or request.endpoint == 'deletar_comunidade' %}active{% endif %}"> {# ATUALIZADO AQUI #}
                        <span class="material-icons">groups</span>
                        Comunidades
                    </a>
                </li>
                 <li>
                    <a href="{{ url_for('passes.manage_passes') }}" class="nav-link {% if request.endpoint.startswith('passes') %}active{% endif %}">
                        <span class="material-icons">vpn_key</span>
                        Passes de Acesso
                    </a>
                </li>
                <li>
                    <a href="{{ url_for('scheduled_messages') }}" class="nav-link {% if request.endpoint.startswith('scheduled_messages') or request.endpoint.startswith('add_scheduled_message') or request.endpoint.startswith('edit_scheduled_message') %}active{% endif %}">
                        <span class="material-icons">schedule_send</span>
                        Msgs Agendadas
                    </a>
                </li>
                <li>
                    <a href="{{ url_for('send_broadcast') }}" class="nav-link {% if request.endpoint == 'send_broadcast' %}active{% endif %}">
                        <span class="material-icons">campaign</span>
                        Broadcast
                    </a>
                </li>
                <li>
                    <a href="{{ url_for('config_messages') }}" class="nav-link {% if request.endpoint == 'config_messages' %}active{% endif %}">
                        <span class="material-icons">settings</span>
                        Configurações
                    </a>
                </li>
                <li>
                    <a href="{{ url_for('logout') }}" class="nav-link logout-link">
                        <span class="material-icons">logout</span>
                        Sair
                    </a>
                </li>
            </ul>
        </aside>
        <main class="main-content">
            <header class="navbar">
                <div class="navbar-left">
                    <h1>{% block page_title %}{% endblock %}</h1>
                </div>
                <div class="navbar-right">
                    <span>Olá, {{ session.username }}</span>
                </div>
            </header>
            <div class="flash-messages">
                {% with messages = get_flashed_messages(with_categories=true) %}
                    {% if messages %}
                        {% for category, message in messages %}
                            <div class="alert alert-{{ category }}">{{ message }}</div>
                        {% endfor %}
                    {% endif %}
                {% endwith %}
            </div>
            {% block content %}{% endblock %}
        </main>
    </div>
    <script>
        $(function() {
            // Inicialização do Datepicker
            $('.datepicker').datepicker({
                dateFormat: 'yy-mm-dd', // Formato para compatibilidade com HTML5 date input
                showButtonPanel: true,
                changeMonth: true,
                changeYear: true
            });

            // Inicialização do DateTimepicker
            $('.datetimepicker').datetimepicker({
                dateFormat: 'yy-mm-dd',
                timeFormat: 'HH:mm',
                hourGrid: 4,
                minuteGrid: 10
            });

            // Fechar mensagens flash automaticamente após 5 segundos
            setTimeout(function() {
                $('.alert').fadeOut('slow', function() {
                    $(this).remove();
                });
            }, 5000); // 5000 milissegundos = 5 segundos
        });

        // Função para formatar moeda (exemplo básico, pode ser melhorado)
        function formatCurrency(value) {
            return parseFloat(value).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        }
    </script>
</body>
</html>